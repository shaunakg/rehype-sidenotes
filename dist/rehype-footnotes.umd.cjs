(function(_,ne){typeof exports=="object"&&typeof module<"u"?module.exports=ne():typeof define=="function"&&define.amd?define(ne):(_=typeof globalThis<"u"?globalThis:_||self,_.RehypeFootnotes=ne())})(this,function(){"use strict";class _{constructor(n,t,r){this.property=n,this.normal=t,r&&(this.space=r)}}_.prototype.property={},_.prototype.normal={},_.prototype.space=null;function ne(e,n){const t={},r={};let l=-1;for(;++l<e.length;)Object.assign(t,e[l].property),Object.assign(r,e[l].normal);return new _(t,r,n)}function ie(e){return e.toLowerCase()}class F{constructor(n,t){this.property=n,this.attribute=t}}F.prototype.space=null,F.prototype.boolean=!1,F.prototype.booleanish=!1,F.prototype.overloadedBoolean=!1,F.prototype.number=!1,F.prototype.commaSeparated=!1,F.prototype.spaceSeparated=!1,F.prototype.commaOrSpaceSeparated=!1,F.prototype.mustUseProperty=!1,F.prototype.defined=!1;let rt=0;const g=Z(),C=Z(),Je=Z(),a=Z(),S=Z(),te=Z(),M=Z();function Z(){return 2**++rt}const Ee=Object.freeze(Object.defineProperty({__proto__:null,boolean:g,booleanish:C,commaOrSpaceSeparated:M,commaSeparated:te,number:a,overloadedBoolean:Je,spaceSeparated:S},Symbol.toStringTag,{value:"Module"})),Ne=Object.keys(Ee);class Ae extends F{constructor(n,t,r,l){let i=-1;if(super(n,t),qe(this,"space",l),typeof r=="number")for(;++i<Ne.length;){const o=Ne[i];qe(this,Ne[i],(r&Ee[o])===Ee[o])}}}Ae.prototype.defined=!0;function qe(e,n,t){t&&(e[n]=t)}const lt={}.hasOwnProperty;function re(e){const n={},t={};let r;for(r in e.properties)if(lt.call(e.properties,r)){const l=e.properties[r],i=new Ae(r,e.transform(e.attributes||{},r),l,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),n[r]=i,t[ie(r)]=r,t[ie(i.attribute)]=r}return new _(n,t,e.space)}const en=re({space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),nn=re({space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function tn(e,n){return n in e?e[n]:n}function rn(e,n){return tn(e,n.toLowerCase())}const ln=re({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:rn,properties:{xmlns:null,xmlnsXLink:null}}),on=re({transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:C,ariaAutoComplete:null,ariaBusy:C,ariaChecked:C,ariaColCount:a,ariaColIndex:a,ariaColSpan:a,ariaControls:S,ariaCurrent:null,ariaDescribedBy:S,ariaDetails:null,ariaDisabled:C,ariaDropEffect:S,ariaErrorMessage:null,ariaExpanded:C,ariaFlowTo:S,ariaGrabbed:C,ariaHasPopup:null,ariaHidden:C,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:S,ariaLevel:a,ariaLive:null,ariaModal:C,ariaMultiLine:C,ariaMultiSelectable:C,ariaOrientation:null,ariaOwns:S,ariaPlaceholder:null,ariaPosInSet:a,ariaPressed:C,ariaReadOnly:C,ariaRelevant:null,ariaRequired:C,ariaRoleDescription:S,ariaRowCount:a,ariaRowIndex:a,ariaRowSpan:a,ariaSelected:C,ariaSetSize:a,ariaSort:null,ariaValueMax:a,ariaValueMin:a,ariaValueNow:a,ariaValueText:null,role:null}}),ot=re({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:rn,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:te,acceptCharset:S,accessKey:S,action:null,allow:null,allowFullScreen:g,allowPaymentRequest:g,allowUserMedia:g,alt:null,as:null,async:g,autoCapitalize:null,autoComplete:S,autoFocus:g,autoPlay:g,blocking:S,capture:null,charSet:null,checked:g,cite:null,className:S,cols:a,colSpan:null,content:null,contentEditable:C,controls:g,controlsList:S,coords:a|te,crossOrigin:null,data:null,dateTime:null,decoding:null,default:g,defer:g,dir:null,dirName:null,disabled:g,download:Je,draggable:C,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:g,formTarget:null,headers:S,height:a,hidden:g,high:a,href:null,hrefLang:null,htmlFor:S,httpEquiv:S,id:null,imageSizes:null,imageSrcSet:null,inert:g,inputMode:null,integrity:null,is:null,isMap:g,itemId:null,itemProp:S,itemRef:S,itemScope:g,itemType:S,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:g,low:a,manifest:null,max:null,maxLength:a,media:null,method:null,min:null,minLength:a,multiple:g,muted:g,name:null,nonce:null,noModule:g,noValidate:g,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:g,optimum:a,pattern:null,ping:S,placeholder:null,playsInline:g,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:g,referrerPolicy:null,rel:S,required:g,reversed:g,rows:a,rowSpan:a,sandbox:S,scope:null,scoped:g,seamless:g,selected:g,shadowRootClonable:g,shadowRootDelegatesFocus:g,shadowRootMode:null,shape:null,size:a,sizes:null,slot:null,span:a,spellCheck:C,src:null,srcDoc:null,srcLang:null,srcSet:null,start:a,step:null,style:null,tabIndex:a,target:null,title:null,translate:null,type:null,typeMustMatch:g,useMap:null,value:C,width:a,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:S,axis:null,background:null,bgColor:null,border:a,borderColor:null,bottomMargin:a,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:g,declare:g,event:null,face:null,frame:null,frameBorder:null,hSpace:a,leftMargin:a,link:null,longDesc:null,lowSrc:null,marginHeight:a,marginWidth:a,noResize:g,noHref:g,noShade:g,noWrap:g,object:null,profile:null,prompt:null,rev:null,rightMargin:a,rules:null,scheme:null,scrolling:C,standby:null,summary:null,text:null,topMargin:a,valueType:null,version:null,vAlign:null,vLink:null,vSpace:a,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:g,disableRemotePlayback:g,prefix:null,property:null,results:a,security:null,unselectable:null}}),it=re({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:tn,properties:{about:M,accentHeight:a,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:a,amplitude:a,arabicForm:null,ascent:a,attributeName:null,attributeType:null,azimuth:a,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:a,by:null,calcMode:null,capHeight:a,className:S,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:a,diffuseConstant:a,direction:null,display:null,dur:null,divisor:a,dominantBaseline:null,download:g,dx:null,dy:null,edgeMode:null,editable:null,elevation:a,enableBackground:null,end:null,event:null,exponent:a,externalResourcesRequired:null,fill:null,fillOpacity:a,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:te,g2:te,glyphName:te,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:a,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:a,horizOriginX:a,horizOriginY:a,id:null,ideographic:a,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:a,k:a,k1:a,k2:a,k3:a,k4:a,kernelMatrix:M,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:a,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:a,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:a,overlineThickness:a,paintOrder:null,panose1:null,path:null,pathLength:a,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:S,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:a,pointsAtY:a,pointsAtZ:a,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:M,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:M,rev:M,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:M,requiredFeatures:M,requiredFonts:M,requiredFormats:M,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:a,specularExponent:a,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:a,strikethroughThickness:a,string:null,stroke:null,strokeDashArray:M,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:a,strokeOpacity:a,strokeWidth:null,style:null,surfaceScale:a,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:M,tabIndex:a,tableValues:null,target:null,targetX:a,targetY:a,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:M,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:a,underlineThickness:a,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:a,values:null,vAlphabetic:a,vMathematical:a,vectorEffect:null,vHanging:a,vIdeographic:a,version:null,vertAdvY:a,vertOriginX:a,vertOriginY:a,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:a,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),at=/^data[-\w.:]+$/i,an=/-[a-z]/g,ut=/[A-Z]/g;function un(e,n){const t=ie(n);let r=n,l=F;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&at.test(n)){if(n.charAt(4)==="-"){const i=n.slice(5).replace(an,ct);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=n.slice(4);if(!an.test(i)){let o=i.replace(ut,st);o.charAt(0)!=="-"&&(o="-"+o),n="data"+o}}l=Ae}return new l(r,n)}function st(e){return"-"+e.toLowerCase()}function ct(e){return e.charAt(1).toUpperCase()}const sn=ne([nn,en,ln,on,ot],"html"),Pe=ne([nn,en,ln,on,it],"svg");var ge={},Oe={};function ft(e,n){for(var t=n,r=0;r<e.length;r++){var l=r===e.length-1,i=e.charAt(r),o=t[i]||(t[i]={chars:{}});l&&(o.self=e),t=o.chars}}function cn(e){if(e.length===0)return ge;for(var n={},t=0,r=e;t<r.length;t++){var l=r[t];ft(l,n)}return n}function dt(e){if(e.length===0)return Oe;for(var n={},t=0,r=e;t<r.length;t++){var l=r[t];n[l]=!0}return n}var me={},fn={type:"String",optional:!0};function pt(e){var n={type:"NoArgument",optional:!1};function t(o){if(n.type&&n.type!==o&&n.type!=="NoArgument")throw new Error('Conflicting pseudo-class argument type: "'.concat(n.type,'" vs "').concat(o,'".'));n.type=o}for(var r=0,l=e;r<l.length;r++){var i=l[r];i==="NoArgument"&&(n.optional=!0),i==="Formula"&&t("Formula"),i==="FormulaOfSelector"&&(t("Formula"),n.ofSelector=!0),i==="String"&&t("String"),i==="Selector"&&t("Selector")}return n}function ht(e){for(var n={},t=0,r=Object.keys(e);t<r.length;t++){var l=r[t],i=e[l];if(i)for(var o=0,s=i;o<s.length;o++){var c=s[o];(n[c]||(n[c]=[])).push(l)}}return n}function dn(e){for(var n=ht(e),t={},r=0,l=Object.keys(n);r<l.length;r++){var i=l[r],o=n[i];o&&(t[i]=pt(o))}return t}var ye=function(){return ye=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},ye.apply(this,arguments)},gt={},Me={wildcard:!0};function mt(e){return e?typeof e=="boolean"?Me:e:gt}function yt(e,n){return function(t,r){return n(e(t),e(r))}}function vt(e){return function(n,t){var r=e(n,t);if(!r)throw new Error("Syntax definition cannot be null or undefined.");return r}}function pn(e,n){return function(t,r){return r===!0?e:n(t===!0?e:t,r)}}function le(e){return function(n,t){if(!t||!n)return t;if(typeof t!="object"||t===null)throw new Error("Unexpected syntax definition extension type: ".concat(t,"."));for(var r=ye({},n),l=0,i=Object.entries(t);l<i.length;l++){var o=i[l],s=o[0],c=o[1],f=e[s];r[s]=f(n[s],c)}return r}}function B(e,n){return n!==void 0?n:e}function Ie(e,n){return n?e?e.concat(n):n:e}function hn(e,n){if(!n)return e;if(!e)return n;for(var t=ye({},e),r=0,l=Object.entries(n);r<l.length;r++){var i=l[r],o=i[0],s=i[1];if(!s){delete t[o];continue}var c=e[o];if(!c){t[o]=s;continue}t[o]=c.concat(s)}return t}var ae=vt(le({baseSyntax:B,tag:pn(Me,le({wildcard:B})),ids:B,classNames:B,namespace:pn(Me,le({wildcard:B})),combinators:Ie,attributes:le({operators:Ie,caseSensitivityModifiers:Ie,unknownCaseSensitivityModifiers:B}),pseudoClasses:le({unknown:B,definitions:hn}),pseudoElements:le({unknown:B,notation:B,definitions:yt(function(e){return Array.isArray(e)?{NoArgument:e}:e},hn)})})),gn={tag:{},ids:!0,classNames:!0,combinators:[],pseudoElements:{unknown:"reject",notation:"singleColon",definitions:["first-letter","first-line"]},pseudoClasses:{unknown:"reject",definitions:{NoArgument:["link","visited","active"]}}},mn=ae(gn,{tag:{wildcard:!0},combinators:[">","+"],attributes:{unknownCaseSensitivityModifiers:"reject",operators:["=","~=","|="]},pseudoElements:{definitions:["before","after"]},pseudoClasses:{unknown:"reject",definitions:{NoArgument:["hover","focus","first-child"],String:["lang"]}}}),Le=ae(mn,{namespace:{wildcard:!0},combinators:["~"],attributes:{operators:["^=","$=","*="]},pseudoElements:{notation:"both"},pseudoClasses:{definitions:{NoArgument:["root","last-child","first-of-type","last-of-type","only-child","only-of-type","empty","target","enabled","disabled","checked","indeterminate"],Formula:["nth-child","nth-last-child","nth-of-type","nth-last-of-type"],Selector:["not"]}}}),Fe=ae(Le,{combinators:["||"],attributes:{caseSensitivityModifiers:["i","I","s","S"]},pseudoClasses:{definitions:{NoArgument:["any-link","local-link","target-within","scope","current","past","future","focus-within","focus-visible","read-write","read-only","placeholder-shown","default","valid","invalid","in-range","out-of-range","required","optional","blank","user-invalid"],Formula:["nth-col","nth-last-col"],String:["dir"],FormulaOfSelector:["nth-child","nth-last-child"],Selector:["current","is","where","has"]}}}),bt=ae(Fe,{pseudoElements:{unknown:"accept"},pseudoClasses:{unknown:"accept"},attributes:{unknownCaseSensitivityModifiers:"accept"}}),yn={css1:gn,css2:mn,css3:Le,"selectors-3":Le,"selectors-4":Fe,latest:Fe,progressive:bt};function ue(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="-"||e==="_"||e==="\\"||e>=" "}function vn(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||e==="-"||e==="_"||e>=" "}function se(e){return e>="a"&&e<="f"||e>="A"&&e<="F"||e>="0"&&e<="9"}var wt={" ":!0,"	":!0,"\n":!0,"\r":!0,"\f":!0},St={'"':!0,"'":!0},De={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0},xt=6,Te="css-selector-parser parse error: ";function Ct(e){e===void 0&&(e={});var n=e.syntax,t=n===void 0?"latest":n,r=e.substitutes,l=e.strict,i=l===void 0?!0:l,o=typeof t=="object"?t:yn[t];o.baseSyntax&&(o=ae(yn[o.baseSyntax],o));var s=o.tag?[!0,!!mt(o.tag).wildcard]:[!1,!1],c=s[0],f=s[1],b=!!o.ids,E=!!o.classNames,I=!!o.namespace,D=o.namespace&&(o.namespace===!0||o.namespace.wildcard===!0);if(I&&!c)throw new Error("".concat(Te,"Namespaces cannot be enabled while tags are disabled."));var W=!!r,j=o.combinators?cn(o.combinators):ge,Q=o.attributes?[!0,o.attributes.operators?cn(o.attributes.operators):ge,o.attributes.caseSensitivityModifiers?dt(o.attributes.caseSensitivityModifiers):Oe,o.attributes.unknownCaseSensitivityModifiers==="accept"]:[!1,ge,Oe,!1],J=Q[0],Xe=Q[1],Vn=Q[2],Kn=Q[3],ol=Kn||Object.keys(Vn).length>0,Ze=o.pseudoClasses?[!0,o.pseudoClasses.definitions?dn(o.pseudoClasses.definitions):me,o.pseudoClasses.unknown==="accept"]:[!1,me,!1],il=Ze[0],al=Ze[1],ul=Ze[2],de=o.pseudoElements?[!0,o.pseudoElements.notation==="singleColon"||o.pseudoElements.notation==="both",!o.pseudoElements.notation||o.pseudoElements.notation==="doubleColon"||o.pseudoElements.notation==="both",o.pseudoElements.definitions?dn(Array.isArray(o.pseudoElements.definitions)?{NoArgument:o.pseudoElements.definitions}:o.pseudoElements.definitions):me,o.pseudoElements.unknown==="accept"]:[!1,!1,!1,me,!1],Xn=de[0],sl=de[1],cl=de[2],Ge=de[3],Zn=de[4],U="",$=U.length,x=0,m="",h=function(u){return m===u},Se=function(){return h("*")||ue(m)},oe=function(u){x=u,m=U.charAt(x)},y=function(){x++,m=U.charAt(x)},z=function(){var u=m;return x++,m=U.charAt(x),u};function H(u){var d=Math.min($-1,x),w=new Error("".concat(Te).concat(u," Pos: ").concat(d,"."));throw w.position=d,w.name="ParserError",w}function p(u,d){if(!u)return H(d)}var Ye=function(){p(x<$,"Unexpected end of input.")},q=function(){return x>=$},pe=function(u){p(x<$,'Expected "'.concat(u,'" but end of input reached.')),p(m===u,'Expected "'.concat(u,'" but "').concat(m,'" found.')),x++,m=U.charAt(x)};function Qe(u){var d=Gn(u,x);if(d)return x+=d.length,m=U.charAt(x),d}function Gn(u,d){var w=U.charAt(d),v=u[w];if(v){var O=Gn(v.chars,d+1);if(O)return O;if(v.self)return v.self}}function xe(){for(var u=z(),d=1;se(m)&&d<xt;)u+=z(),d++;return pl(),String.fromCharCode(parseInt(u,16))}function fl(u){var d="";for(pe(u);x<$;){if(h(u))return y(),d;h("\\")?(y(),h(u)?(d+=u,y()):m===`
`||m==="\f"?y():m==="\r"?(y(),h(`
`)&&y()):se(m)?d+=xe():(d+=m,y())):(d+=m,y())}return d}function P(){if(!ue(m))return null;for(var u="";h("-");)u+=m,y();for(u==="-"&&!vn(m)&&!h("\\")&&H("Identifiers cannot consist of a single hyphen."),i&&u.length>=2&&H("Identifiers cannot start with two hyphens with strict mode on."),De[m]&&H("Identifiers cannot start with hyphens followed by digits.");x<$;)if(vn(m))u+=z();else if(h("\\"))y(),Ye(),se(m)?u+=xe():u+=z();else break;return u}function dl(){for(var u="";x<$&&!h(")");)if(h("\\")){if(y(),q()&&!i)return(u+"\\").trim();Ye(),se(m)?u+=xe():u+=z()}else u+=z();return u.trim()}function pl(){if(m===" "||m==="	"||m==="\f"||m===`
`){y();return}m==="\r"&&y(),m===`
`&&y()}function N(){for(;wt[m];)y()}function Yn(u){u===void 0&&(u=!1),N();for(var d=[Ce(u)];h(",");)y(),N(),d.push(Ce(u));return{type:"Selector",rules:d}}function hl(){pe("["),N();var u;if(h("|")){p(I,"Namespaces are not enabled."),y();var d=P();p(d,"Expected attribute name."),u={type:"Attribute",name:d,namespace:{type:"NoNamespace"}}}else if(h("*")){p(I,"Namespaces are not enabled."),p(D,"Wildcard namespace is not enabled."),y(),pe("|");var w=P();p(w,"Expected attribute name."),u={type:"Attribute",name:w,namespace:{type:"WildcardNamespace"}}}else{var v=P();if(p(v,"Expected attribute name."),u={type:"Attribute",name:v},h("|")){var O=x;if(y(),ue(m)){p(I,"Namespaces are not enabled.");var V=P();p(V,"Expected attribute name."),u={type:"Attribute",name:V,namespace:{type:"NamespaceName",name:v}}}else oe(O)}}if(p(u.name,"Expected attribute name."),N(),q()&&!i)return u;if(h("]"))y();else{if(u.operator=Qe(Xe),p(u.operator,"Expected a valid attribute selector operator."),N(),Ye(),St[m])u.value={type:"String",value:fl(m)};else if(W&&h("$")){y();var K=P();p(K,"Expected substitute name."),u.value={type:"Substitution",name:K}}else{var X=P();p(X,"Expected attribute value."),u.value={type:"String",value:X}}if(N(),q()&&!i)return u;if(!h("]")){var T=P();if(p(T,"Expected end of attribute selector."),u.caseSensitivityModifier=T,p(ol,"Attribute case sensitivity modifiers are not enabled."),p(Kn||Vn[u.caseSensitivityModifier],"Unknown attribute case sensitivity modifier."),N(),q()&&!i)return u}pe("]")}return u}function Qn(){for(var u="";De[m];)u+=z();return p(u!=="","Formula parse error."),parseInt(u)}var gl=function(){return h("-")||h("+")||De[m]};function ml(){if(h("e")||h("o")){var u=P();if(u==="even")return N(),[2,0];if(u==="odd")return N(),[2,1]}var d=null,w=1;if(h("-")&&(y(),w=-1),gl()&&(h("+")&&y(),d=Qn(),!h("\\")&&!h("n")))return[0,d*w];d===null&&(d=1),d*=w;var v;if(h("\\")?(y(),se(m)?v=xe():v=z()):v=z(),p(v==="n",'Formula parse error: expected "n".'),N(),h("+")||h("-")){var O=h("+")?1:-1;return y(),N(),[d,O*Qn()]}else return[d,0]}function Jn(u,d,w){var v;if(h("(")){if(y(),N(),W&&h("$")){y();var O=P();p(O,"Expected substitute name."),v={type:"Substitution",name:O}}else if(w.type==="String")v={type:"String",value:dl()},p(v.value,"Expected ".concat(d," argument value."));else if(w.type==="Selector")v=Yn(!0);else if(w.type==="Formula"){var V=ml(),K=V[0],X=V[1];if(v={type:"Formula",a:K,b:X},w.ofSelector&&(N(),h("o")||h("\\"))){var T=P();p(T==="of","Formula of selector parse error."),N(),v={type:"FormulaOfSelector",a:K,b:X,selector:Ce()}}}else return H("Invalid ".concat(d," signature."));if(N(),q()&&!i)return v;pe(")")}else p(w.optional,"Argument is required for ".concat(d,' "').concat(u,'".'));return v}function he(){if(h("*"))return p(f,"Wildcard tag name is not enabled."),y(),{type:"WildcardTag"};if(ue(m)){p(c,"Tag names are not enabled.");var u=P();return p(u,"Expected tag name."),{type:"TagName",name:u}}else return H("Expected tag name.")}function qn(){if(h("*")){var u=x;if(y(),!h("|")||(y(),!Se()))return oe(u),he();p(I,"Namespaces are not enabled."),p(D,"Wildcard namespace is not enabled.");var d=he();return d.namespace={type:"WildcardNamespace"},d}else if(h("|")){p(I,"Namespaces are not enabled."),y();var d=he();return d.namespace={type:"NoNamespace"},d}else if(ue(m)){var w=P();if(p(w,"Expected tag name."),!h("|"))return p(c,"Tag names are not enabled."),{type:"TagName",name:w};var u=x;if(y(),!Se())return oe(u),{type:"TagName",name:w};p(I,"Namespaces are not enabled.");var d=he();return d.namespace={type:"NamespaceName",name:w},d}else return H("Expected tag name.")}function Ce(u){var d,w;u===void 0&&(u=!1);var v={type:"Rule",items:[]};if(u){var O=Qe(j);O&&(v.combinator=O,N())}for(;x<$;)if(Se())p(v.items.length===0,"Unexpected tag/namespace start."),v.items.push(qn());else if(h("|")){var V=x;if(y(),Se())p(v.items.length===0,"Unexpected tag/namespace start."),oe(V),v.items.push(qn());else{oe(V);break}}else if(h(".")){p(E,"Class names are not enabled."),y();var K=P();p(K,"Expected class name."),v.items.push({type:"ClassName",name:K})}else if(h("#")){p(b,"IDs are not enabled."),y();var X=P();p(X,"Expected ID name."),v.items.push({type:"Id",name:X})}else if(h("["))p(J,"Attributes are not enabled."),v.items.push(hl());else if(h(":")){var T=!1,et=!1;y(),h(":")&&(p(Xn,"Pseudo elements are not enabled."),p(cl,"Pseudo elements double colon notation is not enabled."),T=!0,y());var L=P();if(p(T||L,"Expected pseudo-class name."),p(!T||L,"Expected pseudo-element name."),p(L,"Expected pseudo-class name."),p(!T||Zn||Object.prototype.hasOwnProperty.call(Ge,L),'Unknown pseudo-element "'.concat(L,'".')),et=Xn&&(T||!T&&sl&&Object.prototype.hasOwnProperty.call(Ge,L)),et){var ke=(d=Ge[L])!==null&&d!==void 0?d:Zn&&fn,nt={type:"PseudoElement",name:L},ee=Jn(L,"pseudo-element",ke);ee&&(p(ee.type!=="Formula"&&ee.type!=="FormulaOfSelector","Pseudo-elements cannot have formula argument."),nt.argument=ee),v.items.push(nt)}else{p(il,"Pseudo-classes are not enabled.");var ke=(w=al[L])!==null&&w!==void 0?w:ul&&fn;p(ke,'Unknown pseudo-class: "'.concat(L,'".'));var ee=Jn(L,"pseudo-class",ke),tt={type:"PseudoClass",name:L};ee&&(tt.argument=ee),v.items.push(tt)}}else break;if(v.items.length===0)return q()?H("Expected rule but end of input reached."):H('Expected rule but "'.concat(m,'" found.'));if(N(),!q()&&!h(",")&&!h(")")){var O=Qe(j);N(),v.nestedRule=Ce(),v.nestedRule.combinator=O}return v}return function(u){if(typeof u!="string")throw new Error("".concat(Te,"Expected string input."));return U=u,$=U.length,x=0,m=U.charAt(0),Yn()}}var k=function(){return k=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},k.apply(this,arguments)};function A(e){return function(n,t){var r;return r={},r[n]=function(l){return k({type:e},l)},r[t]=function(l){return typeof l=="object"&&l!==null&&l.type===e},r}}k(k(k(k(k(k(k(k(k(k(k(k(k(k(k(k({},A("Selector")("selector","isSelector")),A("Rule")("rule","isRule")),A("TagName")("tagName","isTagName")),A("Id")("id","isId")),A("ClassName")("className","isClassName")),A("WildcardTag")("wildcardTag","isWildcardTag")),A("NamespaceName")("namespaceName","isNamespaceName")),A("WildcardNamespace")("wildcardNamespace","isWildcardNamespace")),A("NoNamespace")("noNamespace","isNoNamespace")),A("Attribute")("attribute","isAttribute")),A("PseudoClass")("pseudoClass","isPseudoClass")),A("PseudoElement")("pseudoElement","isPseudoElement")),A("String")("string","isString")),A("Formula")("formula","isFormula")),A("FormulaOfSelector")("formulaOfSelector","isFormulaOfSelector")),A("Substitution")("substitution","isSubstitution"));const kt=Ct({syntax:"selectors-4"});function Et(e){if(typeof e!="string")throw new TypeError("Expected `string` as selector, not `"+e+"`");return kt(e)}const bn="֑-߿יִ-﷽ﹰ-ﻼ",wn="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",Nt=new RegExp("^[^"+wn+"]*["+bn+"]"),At=new RegExp("^[^"+bn+"]*["+wn+"]");function Pt(e){const n=String(e||"");return Nt.test(n)?"rtl":At.test(n)?"ltr":"neutral"}function Ot(e){return"children"in e?Sn(e):"value"in e?e.value:""}function Mt(e){return e.type==="text"?e.value:"children"in e?Sn(e):""}function Sn(e){let n=-1;const t=[];for(;++n<e.children.length;)t[n]=Mt(e.children[n]);return t.join("")}const xn=function(e){if(e==null)return Dt;if(typeof e=="function")return ve(e);if(typeof e=="object")return Array.isArray(e)?It(e):Lt(e);if(typeof e=="string")return Ft(e);throw new Error("Expected function, string, or object as test")};function It(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=xn(e[t]);return ve(r);function r(...l){let i=-1;for(;++i<n.length;)if(n[i].apply(this,l))return!0;return!1}}function Lt(e){const n=e;return ve(t);function t(r){const l=r;let i;for(i in e)if(l[i]!==n[i])return!1;return!0}}function Ft(e){return ve(n);function n(t){return t&&t.type===e}}function ve(e){return n;function n(t,r,l){return!!(Tt(t)&&e.call(this,t,typeof r=="number"?r:void 0,l||void 0))}}function Dt(){return!0}function Tt(e){return e!==null&&typeof e=="object"&&"type"in e}function yl(e){return e}const Cn=[],Rt=!0,Re=!1,kn="skip";function jt(e,n,t,r){let l;typeof n=="function"&&typeof t!="function"?(r=t,t=n):l=n;const i=xn(l),o=r?-1:1;s(e,void 0,[])();function s(c,f,b){const E=c&&typeof c=="object"?c:{};if(typeof E.type=="string"){const D=typeof E.tagName=="string"?E.tagName:typeof E.name=="string"?E.name:void 0;Object.defineProperty(I,"name",{value:"node ("+(c.type+(D?"<"+D+">":""))+")"})}return I;function I(){let D=Cn,W,j,Q;if((!n||i(c,f,b[b.length-1]||void 0))&&(D=Ut(t(c,b)),D[0]===Re))return D;if("children"in c&&c.children){const J=c;if(J.children&&D[0]!==kn)for(j=(r?J.children.length:-1)+o,Q=b.concat(J);j>-1&&j<J.children.length;){const Xe=J.children[j];if(W=s(Xe,j,Q)(),W[0]===Re)return W;j=typeof W[1]=="number"?W[1]:j+o}}return D}}}function Ut(e){return Array.isArray(e)?e:typeof e=="number"?[Rt,e]:e==null?Cn:[e]}function _t(e,n,t,r){let l,i,o;typeof n=="function"&&typeof t!="function"?(i=void 0,o=n,l=t):(i=n,o=t,l=r),jt(e,i,s,l);function s(c,f){const b=f[f.length-1],E=b?b.children.indexOf(c):void 0;return o(c,E,b)}}function Bt(e,n){const t=e.schema,r=e.language,l=e.direction,i=e.editableOrEditingHost;let o;if(n.type==="element"){const f=n.properties.xmlLang||n.properties.lang,b=n.properties.type||"text",E=En(n);f!=null&&(e.language=String(f)),t&&t.space==="html"?(n.properties.contentEditable==="true"&&(e.editableOrEditingHost=!0),n.tagName==="svg"&&(e.schema=Pe),E==="rtl"?o=E:E==="ltr"||E!=="auto"&&n.tagName==="html"||E!=="auto"&&n.tagName==="input"&&b==="tel"?o="ltr":(E==="auto"||n.tagName==="bdi")&&(n.tagName==="textarea"?o=je(Ot(n)):n.tagName==="input"&&(b==="email"||b==="search"||b==="tel"||b==="text")?o=n.properties.value?je(String(n.properties.value)):"ltr":_t(n,c)),o&&(e.direction=o)):e.editableOrEditingHost&&(e.editableOrEditingHost=!1)}return s;function s(){e.schema=t,e.language=r,e.direction=l,e.editableOrEditingHost=i}function c(f){if(f.type==="text")return o=je(f.value),o?Re:void 0;if(f!==n&&f.type==="element"&&(f.tagName==="bdi"||f.tagName==="script"||f.tagName==="style"||f.tagName==="textare"||En(f)))return kn}}function je(e){const n=Pt(e);return n==="neutral"?void 0:n}function En(e){const n=e.type==="element"&&typeof e.properties.dir=="string"?e.properties.dir.toLowerCase():void 0;return n==="auto"||n==="ltr"||n==="rtl"?n:void 0}function Ue(e){const n=[],t=String(e||"");let r=t.indexOf(","),l=0,i=!1;for(;!i;){r===-1&&(r=t.length,i=!0);const o=t.slice(l,r).trim();(o||!i)&&n.push(o),l=r+1,r=t.indexOf(",",l)}return n}function $t(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function vl(){}function _e(e){const n=String(e||"").trim();return n?n.split(/[ \t\n\r\f]+/g):[]}function zt(e){return e.join(" ").trim()}function Ht(e,n,t){const r=un(t,e.name),l=n.properties[r.property];let i=Wt(l,r);if(!e.value)return i!==void 0;e.value.type;let o=e.value.value;if(e.caseSensitivityModifier==="i"&&(o=o.toLowerCase(),i&&(i=i.toLowerCase())),i!==void 0)switch(e.operator){case"=":return o===i;case"$=":return o===i.slice(-o.length);case"*=":return i.includes(o);case"^=":return o===i.slice(0,o.length);case"|=":return o===i||o===i.slice(0,o.length)&&i.charAt(o.length)==="-";case"~=":return o===i||_e(i).includes(o)}return!1}function Wt(e,n){if(e!=null)if(typeof e=="boolean"){if(e)return n.attribute}else if(Array.isArray(e)){if(e.length>0)return(n.commaSeparated?$t:zt)(e)}else return String(e)}const Vt=[];function Kt(e,n){return(n.properties.className||Vt).includes(e.name)}function Xt(e,n){return n.properties.id===e.name}function Zt(e,n){return e.name===n.tagName}function Gt(e,n){return function(t,r){let l=Nn(t,"tag");const i=Nn(r??"*","range"),o=[];let s=-1;for(;++s<i.length;){const c=i[s].toLowerCase();if(!n&&c==="*")continue;let f=-1;const b=[];for(;++f<l.length;)if(e(l[f].toLowerCase(),c)){if(!n)return l[f];o.push(l[f])}else b.push(l[f]);l=b}return n?o:void 0}}const Yt=Gt(function(e,n){const t=e.split("-"),r=n.split("-");let l=0,i=0;if(r[i]!=="*"&&t[l]!==r[i])return!1;for(l++,i++;i<r.length;){if(r[i]==="*"){i++;continue}if(!t[l])return!1;if(t[l]===r[i]){l++,i++;continue}if(t[l].length===1)return!1;l++}return!0},!0);function Nn(e,n){const t=e&&typeof e=="string"?[e]:e;if(!t||typeof t!="object"||!("length"in t))throw new Error("Invalid "+n+" `"+t+"`, expected non-empty string");return t}const Qt={}.hasOwnProperty;function G(e,n){const t=e.type==="element"&&Qt.call(e.properties,n)&&e.properties[n];return t!=null&&t!==!1}const Jt=/[ \t\n\f\r]/g;function qt(e){return typeof e=="object"?e.type==="text"?An(e.value):!1:An(e)}function An(e){return e.replace(Jt,"")===""}const er=new Set([9,10,12,13,32]),Pn=48,nr=57;function tr(e){if(e=e.trim().toLowerCase(),e==="even")return[2,0];if(e==="odd")return[2,1];let n=0,t=0,r=i(),l=o();if(n<e.length&&e.charAt(n)==="n"&&(n++,t=r*(l??1),s(),n<e.length?(r=i(),s(),l=o()):r=l=0),l===null||n<e.length)throw new Error(`n-th rule couldn't be parsed ('${e}')`);return[t,r*l];function i(){return e.charAt(n)==="-"?(n++,-1):(e.charAt(n)==="+"&&n++,1)}function o(){const c=n;let f=0;for(;n<e.length&&e.charCodeAt(n)>=Pn&&e.charCodeAt(n)<=nr;)f=f*10+(e.charCodeAt(n)-Pn),n++;return n===c?null:f}function s(){for(;n<e.length&&er.has(e.charCodeAt(n));)n++}}function rr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lr={trueFunc:function(){return!0},falseFunc:function(){return!1}};const On=rr(lr);function or(e){const n=e[0],t=e[1]-1;if(t<0&&n<=0)return On.falseFunc;if(n===-1)return i=>i<=t;if(n===0)return i=>i===t;if(n===1)return t<0?On.trueFunc:i=>i>=t;const r=Math.abs(n),l=(t%r+r)%r;return n>1?i=>i>=t&&i%r===l:i=>i<=t&&i%r===l}function Mn(e){return or(tr(e))}const In={}.hasOwnProperty;function ir(e,n){const t=n||{};function r(l,...i){let o=r.invalid;const s=r.handlers;if(l&&In.call(l,e)){const c=String(l[e]);o=In.call(s,c)?s[c]:r.unknown}if(o)return o.call(this,l,...i)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const ar=Mn.default||Mn,ur=ir("name",{handlers:{"any-link":sr,blank:cr,checked:fr,dir:dr,disabled:Ln,empty:pr,enabled:hr,"first-child":gr,"first-of-type":mr,has:yr,is:Fn,lang:br,"last-child":wr,"last-of-type":Sr,not:xr,"nth-child":Cr,"nth-last-child":kr,"nth-last-of-type":Er,"nth-of-type":Nr,"only-child":Ar,"only-of-type":Pr,optional:Or,"read-only":Mr,"read-write":Dn,required:Tn,root:Ir,scope:Lr},invalid:vr,unknown:Fr});function sr(e,n){return(n.tagName==="a"||n.tagName==="area"||n.tagName==="link")&&G(n,"href")}function R(e,n){if(e.shallow)throw new Error("Cannot use `:"+n.name+"` without parent")}function cr(e,n){return!Rn(n,t);function t(r){return r.type==="element"||r.type==="text"&&!qt(r)}}function fr(e,n){return n.tagName==="input"||n.tagName==="menuitem"?!!((n.properties.type==="checkbox"||n.properties.type==="radio")&&G(n,"checked")):n.tagName==="option"?G(n,"selected"):!1}function dr(e,n,t,r,l){return e.argument,e.argument.type,l.direction===e.argument.value}function Ln(e,n){return(n.tagName==="button"||n.tagName==="input"||n.tagName==="select"||n.tagName==="textarea"||n.tagName==="optgroup"||n.tagName==="option"||n.tagName==="menuitem"||n.tagName==="fieldset")&&G(n,"disabled")}function pr(e,n){return!Rn(n,t);function t(r){return r.type==="element"||r.type==="text"}}function hr(e,n){return!Ln(e,n)}function gr(e,n,t,r,l){return R(l,e),l.elementIndex===0}function mr(e,n,t,r,l){return R(l,e),l.typeIndex===0}function be(e){let n=e._cachedFn;if(!n){const t=e.argument;if(t.type!=="Formula")throw new Error("Expected `nth` formula, such as `even` or `2n+1` (`of` is not yet supported)");n=ar(t.a+"n+"+t.b),e._cachedFn=n}return n}function yr(e,n,t,r,l){e.argument,e.argument.type;const i={...l,found:!1,one:!0,results:[],rootQuery:e.argument,scopeElements:[n],shallow:!1};return ce(i,{type:"root",children:n.children}),i.results.length>0}function vr(){}function Fn(e,n,t,r,l){e.argument,e.argument.type;const i={...l,found:!1,one:!0,results:[],rootQuery:e.argument,scopeElements:[n],shallow:!1};return ce(i,n),i.results[0]===n}function br(e,n,t,r,l){return e.argument,e.argument.type,l.language!==""&&l.language!==void 0&&Yt(l.language,Ue(e.argument.value)).length>0}function wr(e,n,t,r,l){return R(l,e),!!(l.elementCount&&l.elementIndex===l.elementCount-1)}function Sr(e,n,t,r,l){return R(l,e),typeof l.typeIndex=="number"&&typeof l.typeCount=="number"&&l.typeIndex===l.typeCount-1}function xr(e,n,t,r,l){return!Fn(e,n,t,r,l)}function Cr(e,n,t,r,l){const i=be(e);return R(l,e),typeof l.elementIndex=="number"&&i(l.elementIndex)}function kr(e,n,t,r,l){const i=be(e);return R(l,e),!!(typeof l.elementCount=="number"&&typeof l.elementIndex=="number"&&i(l.elementCount-l.elementIndex-1))}function Er(e,n,t,r,l){const i=be(e);return R(l,e),typeof l.typeCount=="number"&&typeof l.typeIndex=="number"&&i(l.typeCount-1-l.typeIndex)}function Nr(e,n,t,r,l){const i=be(e);return R(l,e),typeof l.typeIndex=="number"&&i(l.typeIndex)}function Ar(e,n,t,r,l){return R(l,e),l.elementCount===1}function Pr(e,n,t,r,l){return R(l,e),l.typeCount===1}function Or(e,n){return!Tn(e,n)}function Mr(e,n,t,r,l){return!Dn(e,n,t,r,l)}function Dn(e,n,t,r,l){return n.tagName==="input"||n.tagName==="textarea"?!G(n,"readOnly")&&!G(n,"disabled"):!!l.editableOrEditingHost}function Tn(e,n){return(n.tagName==="input"||n.tagName==="textarea"||n.tagName==="select")&&G(n,"required")}function Ir(e,n,t,r,l){return!!((!r||r.type==="root")&&l.schema&&(l.schema.space==="html"||l.schema.space==="svg")&&(n.tagName==="html"||n.tagName==="svg"))}function Lr(e,n,t,r,l){return l.scopeElements.includes(n)}function Rn(e,n){const t=e.children;let r=-1;for(;++r<t.length;)if(n(t[r]))return!0;return!1}function Fr(e){const n=e;throw new Error("Unknown pseudo-selector `"+n.name+"`")}function Dr(e,n,t,r,l){for(const i of e.items)if(i.type==="Attribute"){if(!Ht(i,n,l.schema))return!1}else if(i.type==="Id"){if(!Xt(i,n))return!1}else if(i.type==="ClassName"){if(!Kt(i,n))return!1}else if(i.type==="PseudoClass"){if(!ur(i,n,t,r,l))return!1}else{if(i.type==="PseudoElement")throw new Error("Invalid selector: `::"+i.name+"`");if(i.type==="TagName"&&!Zt(i,n))return!1}return!0}const Tr=[];function ce(e,n){n&&Un(e,[],n,void 0,void 0,n)}function Be(e,n,t){const r=e[n];r?r.push(t):e[n]=[t]}function Rr(e,n,t,r){const l=we(n.descendant,n.directChild);let i,o=-1;const s={count:0,types:new Map},c={count:0,types:new Map};for(;++o<t.children.length;)jn(s,t.children[o]);for(o=-1;++o<t.children.length;){const f=t.children[o],b=f.type==="element"?f.tagName.toUpperCase():void 0;if(e.elementIndex=c.count,e.typeIndex=b&&c.types.get(b)||0,e.elementCount=s.count,e.typeCount=b?s.types.get(b):0,"children"in f){const E=we(l,i),I=Un(e,E,t.children[o],o,t,r);i=we(I.generalSibling,I.adjacentSibling)}if(e.one&&e.found)break;jn(c,t.children[o])}}function jr(e,n,t,r,l){const i={adjacentSibling:void 0,descendant:void 0,directChild:void 0,generalSibling:void 0};let o=-1;for(;++o<n.length;){const s=n[o];if(e.one&&e.found)break;if(e.shallow&&s.nestedRule)throw new Error("Expected selector without nesting");if(Dr(s,t,r,l,e)){const c=s.nestedRule;if(c){const f=c.combinator==="+"?"adjacentSibling":c.combinator==="~"?"generalSibling":c.combinator===">"?"directChild":"descendant";Be(i,f,c)}else e.found=!0,e.results.includes(t)||e.results.push(t)}s.combinator===void 0?Be(i,"descendant",s):s.combinator==="~"&&Be(i,"generalSibling",s)}return i}function we(e,n){return e&&n&&e.length>0&&n.length>0?[...e,...n]:e&&e.length>0?e:n&&n.length>0?n:Tr}function jn(e,n){if(n.type==="element"){const t=n.tagName.toUpperCase(),r=(e.types.get(t)||0)+1;e.count++,e.types.set(t,r)}}function Un(e,n,t,r,l,i){let o={adjacentSibling:void 0,descendant:void 0,directChild:void 0,generalSibling:void 0};const s=Bt(e,t);if(t.type==="element"){let c=e.rootQuery.rules;l&&l!==i&&(c=e.rootQuery.rules.filter(f=>f.combinator===void 0||f.combinator===">"&&l===i)),o=jr(e,we(n,c),t,r,l)}return"children"in t&&!e.shallow&&!(e.one&&e.found)&&Rr(e,o,t,i),s(),o}function Ur(e,n,t){const r=ze(e,n,t);return r.one=!0,r.shallow=!0,ce(r,n||void 0),r.results.length>0}function fe(e,n,t){const r=ze(e,n,t);return r.one=!0,ce(r,n||void 0),r.results[0]}function $e(e,n,t){const r=ze(e,n,t);return ce(r,n||void 0),r.results}function ze(e,n,t){return{direction:"ltr",editableOrEditingHost:!1,elementCount:void 0,elementIndex:void 0,found:!1,language:void 0,one:!1,results:[],rootQuery:Et(e),schema:t==="svg"?Pe:sn,scopeElements:n?n.type==="root"?n.children:[n]:[],shallow:!1,typeIndex:void 0,typeCount:void 0}}const _r=e=>(...n)=>{const t=e(...n);let r=t.next();do{if(r.done)return r.value;if(r.value==null)return;r=t.next(r.value)}while(!r.done)},_n=/[#.]/g;function Br(e,n){const t=e||"",r={};let l=0,i,o;for(;l<t.length;){_n.lastIndex=l;const s=_n.exec(t),c=t.slice(l,s?s.index:t.length);c&&(i?i==="#"?r.id=c:Array.isArray(r.className)?r.className.push(c):r.className=[c]:o=c,l+=c.length),s&&(i=s[0],l++)}return{type:"element",tagName:o||n||"div",properties:r,children:[]}}const He={}.hasOwnProperty;function Bn(e,n,t){const r=t&&Wr(t);function l(i,o,...s){let c=-1,f;if(i==null){f={type:"root",children:[]};const b=o;s.unshift(b)}else if(f=Br(i,n),f.tagName=f.tagName.toLowerCase(),r&&He.call(r,f.tagName)&&(f.tagName=r[f.tagName]),$r(o))s.unshift(o);else{let b;for(b in o)He.call(o,b)&&zr(e,f.properties,b,o[b])}for(;++c<s.length;)We(f.children,s[c]);return f.type==="element"&&f.tagName==="template"&&(f.content={type:"root",children:f.children},f.children=[]),f}return l}function $r(e){if(e===null||typeof e!="object"||Array.isArray(e))return!0;if(typeof e.type!="string")return!1;const n=e,t=Object.keys(e);for(const r of t){const l=n[r];if(l&&typeof l=="object"){if(!Array.isArray(l))return!0;const i=l;for(const o of i)if(typeof o!="number"&&typeof o!="string")return!0}}return!!("children"in e&&Array.isArray(e.children))}function zr(e,n,t,r){const l=un(e,t);let i=-1,o;if(r!=null){if(typeof r=="number"){if(Number.isNaN(r))return;o=r}else typeof r=="boolean"?o=r:typeof r=="string"?l.spaceSeparated?o=_e(r):l.commaSeparated?o=Ue(r):l.commaOrSpaceSeparated?o=_e(Ue(r).join(" ")):o=$n(l,l.property,r):Array.isArray(r)?o=r.concat():o=l.property==="style"?Hr(r):String(r);if(Array.isArray(o)){const s=[];for(;++i<o.length;){const c=$n(l,l.property,o[i]);s[i]=c}o=s}if(l.property==="className"&&Array.isArray(n.className)){const s=o;o=n.className.concat(s)}n[l.property]=o}}function We(e,n){let t=-1;if(n!=null)if(typeof n=="string"||typeof n=="number")e.push({type:"text",value:String(n)});else if(Array.isArray(n))for(;++t<n.length;)We(e,n[t]);else if(typeof n=="object"&&"type"in n)n.type==="root"?We(e,n.children):e.push(n);else throw new Error("Expected node, nodes, or string, got `"+n+"`")}function $n(e,n,t){if(typeof t=="string"){if(e.number&&t&&!Number.isNaN(Number(t)))return Number(t);if((e.boolean||e.overloadedBoolean)&&(t===""||ie(t)===ie(n)))return!0}return t}function Hr(e){const n=[];let t;for(t in e)He.call(e,t)&&n.push([t,e[t]].join(": "));return n.join("; ")}function Wr(e){const n={};let t=-1;for(;++t<e.length;)n[e[t].toLowerCase()]=e[t];return n}const Vr=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],Y=Bn(sn,"div");Bn(Pe,"g",Vr);const Kr="address,article,aside,blockquote,canvas,dd,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,hr,li,main,nav,noscript,ol,output,p,pre,section,table,tfoot,ul,video".split(","),Xr=["div","section","article","main"],Ve=(e,n=0)=>e.type!=="element"&&e.type!=="root"||e.children.length===0?n+1:Math.max(...e.children.map(t=>Ve(t,n+1))),Zr=(e,n)=>Ve(e)-Ve(n),Ke=e=>e!=null&&e.type==="element";function Gr(e,n){return e.type!=="element"?e:Y(e.tagName,e.properties,[Y(n.tagName,n.properties,[...e.children])])}function Yr(e){const n=e.children.filter((t,r)=>t.type!=="text"||r!=0&&r!=e.children.length-1?!0:!t.value.match(/^\s+$/));return Y(e.tagName,e.properties,n)}function zn(e,n){if(n.children.includes(e))return n;let t;const r=n.children.filter(Ke);for(const l of r)if(t=zn(e,l),t!==void 0)return t}const Qr=(e,n)=>{const t=`${e.properties.id}`,r=fe(`[href="#${t}"]`,n);return r===void 0&&console.warn(`Failed to find matching footnote reference for #${t} using selector [href="#${t}"]`),r};function Jr(e,n){const t=`${e.properties.id}`,r=/fn[-:][\da-zA-Z]+$/.test(t),l=fe(`[data-footnotes] [id="${t}"], .footnotes [id="${t}"]`,n)!=null,i=fe(`[href="#${t}"]`,n)!=null;if(/[a-zA-Z]+$/.test(t)){const o=fe(`[href="#${t}"]`,n);o&&o.properties&&(o.properties.class=(o.properties.class||"")+" annotation")}return r&&l&&i}function qr(e,n){const t=Yr(e),r=Ke(t.children[0])?t.children:[Y("p")].concat(t.children);r[0].children.unshift(Y("sup",{class:"Sidenote-number"},[n+" "]));const o=/[a-zA-Z]+$/.test(`${e.properties.id}`)?"Sidenote annotation":"Sidenote";return Y(`aside.${o}`,{...e.properties,role:"doc-footnote"},[`
 `,...r.map(s=>Gr(s,Y("small",{class:"Sidenote-small"},[]))),`
 `])}function el(e,n){const t=Xr.map(l=>`${l}:has([id="${e}"])`).join(", "),r=$e(t,n).sort(Zr);return r.length===0&&n.type==="root"?n:(r.length===0&&console.warn(`Failed to find logical section parent with selector: ${t}`),r[0])}function nl(e,n){const t=Kr.map(r=>`${r}:has([id="${e}"])`).join(", ");return n.children.filter(Ke).find(r=>Ur(t,r))}const Hn=e=>e.type==="text"?e.value:e.type==="comment"?"":e.children.map(Hn).join("");function Wn(e,n){const t=zn(e,n);if(!t)return;const r=t==null?void 0:t.children.indexOf(e);if(r!==-1)return t.children.splice(r,1)[0]}const tl=_r(function*(n,t){if(!Jr(n,t))return;const r=yield Qr(n,t),l=String(r.properties.id),i=yield qr(n,Hn(r)),o=yield el(l,t),s=yield nl(l,o),c=o.children.indexOf(s);o.children.splice(c+1,0,{type:"text",value:`
 `},i),Wn(n,t)});function rl(e){if($e(".footnotes li, [data-footnotes] li",e).reverse().forEach(r=>tl(r,e)),$e(".footnotes li, [data-footnotes] li",e).length===0){const r=fe(".footnotes, [data-footnotes]",e);r&&Wn(r,e)}else console.warn("Some footnotes were not transformed.");return e}function ll(){return rl}return ll});
